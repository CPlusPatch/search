import { match } from "assert";
import { SearxSearchResult, SearxAutoCompleteResult } from "../types/types";

function encodeQuery(query: string): string {
	return encodeURIComponent(query).replace("%20", "+");
}

function decodeQuery(query: string): string {
	return decodeURIComponent(query.replace("+", "%20"));
}

async function getSearchResults(query: string): Promise<SearxSearchResult> {
	const response: Response = await fetch(`http://localhost:8888/search?q=${query}&format=json`);
	const results: SearxSearchResult = await response.json();

	return results;
}

async function getAutoCompleteResults(query: string): Promise<SearxAutoCompleteResult> {
	const response: Response = await fetch(`http://localhost:8888/autocompleter?q=${query}`);
	const results: SearxAutoCompleteResult = await response.json();

	return results;
}

function getSearchEngineIcon(engine: string, className: string) {
	switch (engine) {
		case ("google"): {
			return (
				<svg
					xmlns="http://www.w3.org/2000/svg"
					xmlnsXlink="http://www.w3.org/1999/xlink"
					className={className}
					viewBox="0 0 32 32">
					<defs>
						<path
							id="A"
							d="M44.5 20H24v8.5h11.8C34.7 33.9 30.1 37 24 37c-7.2 0-13-5.8-13-13s5.8-13 13-13c3.1 0 5.9 1.1 8.1 2.9l6.4-6.4C34.6 4.1 29.6 2 24 2 11.8 2 2 11.8 2 24s9.8 22 22 22c11 0 21-8 21-22 0-1.3-.2-2.7-.5-4z"></path>
					</defs>
					<clipPath id="B">
						<use xlinkHref="#A"></use>
					</clipPath>
					<path
						fill="#fbbc05"
						d="M0 37V11l17 13z"
						clipPath="url(#B)"
						transform="matrix(.72727 0 0 .72727 -.955 -1.455)"></path>
					<path
						fill="#ea4335"
						d="M0 11l17 13 7-6.1L48 14V0H0z"
						clipPath="url(#B)"
						transform="matrix(.72727 0 0 .72727 -.955 -1.455)"></path>
					<path
						fill="#34a853"
						d="M0 37l30-23 7.9 1L48 0v48H0z"
						clipPath="url(#B)"
						transform="matrix(.72727 0 0 .72727 -.955 -1.455)"></path>
					<path
						fill="#4285f4"
						d="M48 48L17 24l-4-3 35-10z"
						clipPath="url(#B)"
						transform="matrix(.72727 0 0 .72727 -.955 -1.455)"></path>
				</svg>
			);
		}
		case ("duckduckgo"): {
			return (
				<svg
					xmlns="http://www.w3.org/2000/svg"
					xmlnsXlink="http://www.w3.org/1999/xlink"
					className={className}
					viewBox="0 0 32 32">
					<g transform="matrix(.26667 0 0 .26667 -17.955 -5.057)">
						<circle
							cx="127.332"
							cy="78.966"
							r="51.15"
							fill="#de5833"></circle>
						<defs>
							<path
								id="A"
								d="M178.684 78.824c0 28.316-23.035 51.354-51.354 51.354-28.313 0-51.348-23.04-51.348-51.354s23.036-51.35 51.348-51.35c28.318 0 51.354 23.036 51.354 51.35z"></path>
						</defs>
						<clipPath id="B">
							<use xlinkHref="#A"></use>
						</clipPath>
						<g clipPath="url(#B)">
							<path
								fill="#d5d7d8"
								d="M148.293 155.158c-1.8-8.285-12.262-27.04-16.23-34.97s-7.938-19.1-6.13-26.322c.328-1.312-3.436-11.308-2.354-12.015 8.416-5.5 10.632.6 14.002-1.862 1.734-1.273 4.1 1.047 4.7-1.06 2.158-7.567-3.006-20.76-8.77-26.526-1.885-1.88-4.77-3.06-8.03-3.687-1.254-1.713-3.275-3.36-6.138-4.88-3.188-1.697-10.12-3.938-13.717-4.535-2.492-.4-3.055.287-4.12.46.992.088 5.7 2.414 6.615 2.55-.916.62-3.607-.028-5.324.742-.865.392-1.512 1.877-1.506 2.58 4.9-.496 12.574-.016 17.1 2-3.602.4-9.08.867-11.436 2.105-6.848 3.608-9.873 12.035-8.07 22.133 1.804 10.075 9.738 46.85 12.262 59.13 2.525 12.264-5.408 20.2-10.455 22.354l5.408.363-1.8 3.967c6.484.72 13.695-1.44 13.695-1.44-1.438 3.965-11.176 5.412-11.176 5.412s4.7 1.438 12.258-1.447l12.263-4.688 3.604 9.373 6.854-6.847 2.885 7.2c.014-.001 5.424-1.808 3.62-10.103z"></path>
							<path
								fill="#fff"
								d="M150.47 153.477c-1.795-8.3-12.256-27.043-16.228-34.98s-7.935-19.112-6.13-26.32c.335-1.3.34-6.668 1.43-7.38 8.4-5.494 7.812-.184 11.187-2.645 1.74-1.27 3.133-2.806 3.738-4.912 2.164-7.572-3.006-20.76-8.773-26.53-1.88-1.88-4.768-3.062-8.023-3.686-1.252-1.718-3.27-3.36-6.13-4.882-5.4-2.862-12.074-4.006-18.266-2.883 1 .1 3.256 2.138 4.168 2.273-1.38.936-5.053.815-5.03 2.896 4.916-.492 10.303.285 14.834 2.297-3.602.4-6.955 1.3-9.3 2.543-6.854 3.603-8.656 10.812-6.854 20.914 1.807 10.097 9.742 46.873 12.256 59.126 2.527 12.26-5.402 20.188-10.45 22.354l5.408.36-1.8 3.973c6.484.72 13.695-1.44 13.695-1.44-1.438 3.974-11.176 5.406-11.176 5.406s4.686 1.44 12.258-1.445l12.27-4.688 3.604 9.373 6.852-6.85 2.9 7.215c-.016.007 5.388-1.797 3.58-10.088z"></path>
							<path
								fill="#2d4f8e"
								d="M109.02 70.69a3.785 3.785 0 013.79-3.787c2.1 0 3.785 1.694 3.785 3.787s-1.695 3.786-3.785 3.786a3.784 3.784 0 01-3.79-3.786z"></path>
							<path
								fill="#fff"
								d="M113.507 69.43a.98.98 0 01.98-.983.982.982 0 11-.98.983z"></path>
							<path
								fill="#2d4f8e"
								d="M134.867 68.445a3.255 3.255 0 113.252 3.258 3.26 3.26 0 01-3.252-3.258z"></path>
							<path
								fill="#fff"
								d="M138.725 67.363c0-.463.38-.843.838-.843a.84.84 0 01.846.843c0 .47-.367.842-.846.842a.84.84 0 01-.838-.842z"></path>
							<linearGradient
								id="C"
								x1="105.318"
								x2="113.887"
								y1="60.979"
								y2="60.979"
								gradientUnits="userSpaceOnUse">
								<stop offset="0.006" stopColor="#6176b9"></stop>
								<stop offset="0.691" stopColor="#394a9f"></stop>
							</linearGradient>
							<path
								fill="url(#C)"
								d="M113.886 59.718s-2.854-1.3-5.63.453-2.668 3.523-2.668 3.523-1.473-3.283 2.453-4.892 5.844.916 5.844.916z"></path>
							<linearGradient
								id="D"
								x1="132.273"
								x2="140.078"
								y1="58.371"
								y2="58.371"
								gradientUnits="userSpaceOnUse">
								<stop offset="0.006" stopColor="#6176b9"></stop>
								<stop offset="0.691" stopColor="#394a9f"></stop>
							</linearGradient>
							<path
								fill="url(#D)"
								d="M140.078 59.458s-2.05-1.172-3.643-1.152c-3.27.043-4.162 1.488-4.162 1.488s.55-3.445 4.732-2.754c2.268.377 3.073 2.418 3.073 2.418z"></path>
						</g>
						<path
							fill="#fdd20a"
							d="M124.4 85.295c.38-2.3 6.3-6.625 10.5-6.887 4.2-.265 5.5-.205 9-1.043s12.535-3.088 15.033-4.242c2.504-1.156 13.104.572 5.63 4.738-3.232 1.8-11.943 5.13-18.172 6.987-6.22 1.86-10-1.776-12.06 1.28-1.646 2.432-.334 5.762 7.1 6.453 10.037.93 19.66-4.52 20.72-1.625s-8.625 6.508-14.525 6.623c-5.893.1-17.77-3.896-19.555-5.137s-4.165-4.13-3.67-7.148z"></path>
						<path
							fill="#65bc46"
							d="M128.943 115.592s-14.102-7.52-14.332-4.47c-.238 3.056 0 15.5 1.643 16.45s13.396-6.108 13.396-6.108zm5.403-.474s9.635-7.285 11.754-6.815c2.1.48 2.582 15.5.7 16.23-1.88.7-12.908-3.813-12.908-3.813z"></path>
						<path
							fill="#43a244"
							d="M125.53 116.4c0 4.932-.7 7.05 1.4 7.52s6.104 0 7.518-.938.232-7.28-.232-8.465c-.477-1.174-8.696-.232-8.696 1.884z"></path>
						<path
							fill="#65bc46"
							d="M126.426 115.292c0 4.933-.707 7.05 1.4 7.52 2.106.48 6.104 0 7.52-.938 1.4-.94.23-7.28-.236-8.466-.473-1.173-8.692-.227-8.692 1.885z"></path>
						<circle
							cx="127.331"
							cy="78.965"
							r="57.5"
							fill="none"
							stroke="#de5833"
							strokeWidth="5"></circle>
					</g>
				</svg>
			);
		}

		case ("wikidata"): {
			return (
				<svg
					xmlns="http://www.w3.org/2000/svg"
					className={className}
					viewBox="0 0 32 32">
					<path
						fill="#900"
						d="M0 25.887h1.154V6.11H0zm2.384 0H5.92V6.11H2.384zM7.075 6.11v19.775h3.537V6.11z"></path>
					<path
						fill="#396"
						d="M28.462 25.89h1.154V6.11h-1.154zm2.384-19.78v19.78H32V6.11zM11.805 25.89h1.154V6.11h-1.154zM14.19 6.11v19.777h1.154V6.11z"></path>
					<path
						fill="#069"
						d="M16.534 25.89h3.538V6.11h-3.538zm4.69 0h1.23V6.11h-1.23zM23.61 6.11v19.777h3.537V6.11z"></path>
				</svg>
			);
		}

		case ("wikipedia"): {
			return (
				<svg xmlns="http://www.w3.org/2000/svg" className={className} viewBox="0 0 512 512">
					<rect width="512" height="512" fill="#eceff1" rx="77"></rect>
					<path
						fill="#2f2f2f"
						d="M57 147l-1 1v7c0 2 2 3 5 3 21 1 21 5 29 24l94 205c7 15 17 17 26-1l47-92 44 92c8 16 17 17 25 0l90-203c8-18 20-25 37-25 2 0 3-1 3-3v-7l-1-1h-83l-1 1v7c0 2 2 3 4 3 11 0 30 2 22 20l-73 173-3-1-45-92 38-75c9-16 11-25 27-25 2 0 4-1 4-3v-7l-1-1h-67l-1 1v7c0 3 4 3 7 3 19 1 17 8 11 20l-29 58-26-54c-9-17-11-22 2-23 4-1 9-1 9-4v-7l-1-1h-72l-1 1v8c0 2 2 2 5 2 12 2 12 3 24 27l42 88-39 78-3-1-80-174c-8-18 3-17 19-18 3 0 3-1 3-3v-7l-1-1z"
					></path>
				</svg>
			)
		}

		case ("qwant"): {
			return (
				<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64" className={className}>
					<path
						fill="#4ba2ea"
						d="M50.756 61.298c.293.607.586 1.506 1.213 1.862.464.188.968.253 1.465.188h9.08a1.49 1.49 0 001.318-2.176l-1.716-3.243-3.494-6.6a3.342 3.342 0 01-.44-.962s-.126-.21.042-.774c.167-.418 2.28-4.582 2.406-5 .858-2.657 11.298-27.826-18.327-30.4a6.71 6.71 0 01.649.398 21.09 21.09 0 016.318 6.297 20.773 20.773 0 011.6 19.3 20.15 20.15 0 01-1.569 2.971 20.52 20.52 0 01-3.724 4.352c-.346.24-.614.574-.774.962-.116.35-.094.732.063 1.067z"></path>
					<path
						fill="#ff3b4a"
						d="M.2 28.41c4.77-3.243 9.582-3.452 11.088 1.025a.94.94 0 00-.021.23c-1.317 11.217 6.61 21.416 17.804 22.91a20.43 20.43 0 005.649-.021c.46-.063.9-.146 1.36-.23a2.73 2.73 0 011.004-.084c.523 6.402-19.562 8.076-31.99-7.24C2.03 41.213.545 33.577.2 28.41"></path>
					<path
						fill="#65cee7"
						d="M62.242 41.36a30.244 30.244 0 01-1.904 4.666l-.48.92-.732 1.276c-.356.46-.658.958-.9 1.485l.02-.084c.168-.418.315-.844.44-1.276 4.472-13.92-2.723-28.907-16.382-34.123-.105-.063-.188-.105-.293-.167.795.418-3.766-11.068 5.712-9.582.398.21.795.44 1.193.67a30.11 30.11 0 017.239 6.067 30.41 30.41 0 015.356 8.808 31.95 31.95 0 012.134 11.005c.102 3.5-.372 7-1.402 10.335z"></path>
					<path
						fill="#87c966"
						d="M50.254 9.14a5.7 5.7 0 01-.398 2.071 5.62 5.62 0 01-5.19 3.515 5.674 5.674 0 01-2.657-.67 21.012 21.012 0 00-8.37-2.594c-3.656-.34-7.336.32-10.65 1.904a20.11 20.11 0 00-4.477 2.866 20.43 20.43 0 00-3.4 3.64 21.037 21.037 0 00-3.703 8.766c-10.19-12.47 10.733-32.554 34.207-25 .398.105.816.23 1.213.356.293.146.607.293.9.46h.02A5.62 5.62 0 0150.26 9.14z"></path>
					<path d="M46.698 3.93a6.42 6.42 0 00-1.088-.293 27.35 27.35 0 00-5.44-.9c-.544-.042-1.088-.042-1.653-.042C24.02 2.763 12.11 14.16 11.403 28.64a1.64 1.64 0 00-.042.293l-.063.48a5.586 5.586 0 01-5.502 4.56H5.63a5.58 5.58 0 01-5.42-5.585c0-.25.02-.48.042-.71a30.99 30.99 0 012.803-9.519c1.56-3.3 3.71-6.268 6.34-8.787a32.16 32.16 0 018.954-6.046A31.77 31.77 0 0128.914.688a37.195 37.195 0 016.297.042c1.472.126 2.933.357 4.373.7a31.97 31.97 0 017.113 2.511z"></path>
					<path
						fill="#af27cc"
						d="M41.697 61.256c-.293.837-1.15.983-1.925 1.172-.92.23-1.84.398-2.783.544-1.695.25-3.4.356-5.105.44a28.46 28.46 0 01-5.335-.335 35.606 35.606 0 01-5.502-1.255 30.153 30.153 0 01-11.61-6.862 29.67 29.67 0 01-4.561-5.523 30.68 30.68 0 01-4.101-9.854 35.84 35.84 0 01-.586-11.088v-.084C.955 41.982 11.674 52.88 25.232 53.87c.732.063 1.465.084 2.218.084 3.287.008 6.547-.58 9.624-1.736a.53.53 0 01.146.042 1.45 1.45 0 01.9.816l2.05 4.1c.02.042.042.105.063.146l1.046 2.092c.314.586.67 1.15.418 1.84z"></path>
				</svg>
			);
		}
	}
}

export {
	getSearchResults,
	getAutoCompleteResults,
	getSearchEngineIcon,
	encodeQuery,
	decodeQuery
};